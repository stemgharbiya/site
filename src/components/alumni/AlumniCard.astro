---
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import defaultImage from "../../assets/images/alumni/default.png";
import "../../styles/image-filters.css";

type Student = CollectionEntry<"alumniCollection">["data"]["students"][number];

interface Props {
  student: Student;
}

const { student } = Astro.props;
const classText = student.classRank
  ? `${student.class} Â· Class rank ${student.classRank}`
  : student.class;
const nationalText = student.nationalRank
  ? `National rank ${student.nationalRank}`
  : "";
---

<article class="group surface h-full overflow-hidden border-border transition-colors duration-300 hover:border-primary/70">
  <div class="p-5">
    <div class="flex items-center gap-4">
      <div class="h-16 w-16 shrink-0 overflow-hidden rounded-full border border-border bg-secondary/60">
        <Image
          src={student.image || defaultImage}
          alt={student.name}
          class="h-full w-full object-cover"
        />
      </div>
      <div class="min-w-0">
        <h3 class="truncate text-lg font-semibold text-foreground">{student.name}</h3>
        <p class="mt-1 text-sm text-muted-foreground">{classText}</p>
        {nationalText && <p class="text-xs text-muted-foreground">{nationalText}</p>}
      </div>
    </div>

    <div class="mt-5 rounded-xl border border-border bg-background/60 p-4 transition-colors duration-300 group-hover:border-primary/40">
      <div class="flex items-center gap-3">
        <div class="h-10 w-10 overflow-hidden rounded-lg border border-border bg-background p-1">
          <Image
            src={student.university.logo}
            alt={student.university.name}
            class="h-full w-full object-contain filter-blacked-50 dark:filter-grayscale"
          />
        </div>
        <div class="min-w-0">
          <p class="truncate text-sm font-semibold text-foreground">{student.university.name}</p>
          <p class="text-xs text-muted-foreground">Class of {student.university.classYear}</p>
        </div>
      </div>

      {(student.university.major || student.university.financialAid) && (
        <div class="mt-3 space-y-1 text-xs text-muted-foreground">
          {student.university.major && <p>Major: {student.university.major}</p>}
          {student.university.financialAid && <p>{student.university.financialAid}</p>}
        </div>
      )}
    </div>
  </div>
</article>